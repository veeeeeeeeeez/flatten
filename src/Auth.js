import React, { useState } from 'react'
import { supabase } from './supabaseClient'

export default function Auth() {
  const [loading, setLoading] = useState(false)
  const [email, setEmail] = useState('')
  const [password, setPassword] = useState('')
  const [isSignUp, setIsSignUp] = useState(false)

  const handleAuth = async (e) => {
    e.preventDefault()
    setLoading(true)

    try {
      if (isSignUp) {
        const { error } = await supabase.auth.signUp({
          email,
          password,
        })
        if (error) throw error
        alert('Check your email for the confirmation link!')
      } else {
        const { error } = await supabase.auth.signInWithPassword({
          email,
          password,
        })
        if (error) throw error
      }
    } catch (error) {
      alert(error.message)
    } finally {
      setLoading(false)
    }
  }

  return (
    <div className="min-h-screen flex items-center justify-center bg-gray-50">
      <div className="max-w-md w-full space-y-8">
        <div>
          <div className="flex justify-center">
            <svg width="120" height="30" viewBox="0 0 603 150" fill="none" xmlns="http://www.w3.org/2000/svg">
              <rect x="10" y="10" width="130" height="130" fill="white" stroke="#1E1E1E" strokeWidth="20"/>
              <line x1="25" y1="115" x2="125" y2="115" stroke="#1E1E1E" strokeWidth="20"/>
              <path d="M235.98 55.0909V69.8636H192.216V55.0909H235.98ZM202.234 126V49.9666C202.234 44.8269 203.234 40.5644 205.234 37.179C207.266 33.7936 210.036 31.2545 213.544 29.5618C217.053 27.8691 221.038 27.0227 225.501 27.0227C228.517 27.0227 231.271 27.2535 233.764 27.7152C236.288 28.1768 238.165 28.5923 239.396 28.9616L235.888 43.7344C235.118 43.4882 234.164 43.2573 233.026 43.0419C231.918 42.8265 230.779 42.7188 229.609 42.7188C226.716 42.7188 224.701 43.3958 223.562 44.75C222.423 46.0734 221.854 47.9354 221.854 50.3359V126H202.234ZM267.661 31.4545V126H247.994V31.4545H267.661ZM303.635 127.339C299.11 127.339 295.079 126.554 291.539 124.984C288 123.384 285.199 121.03 283.137 117.921C281.106 114.782 280.091 110.873 280.091 106.195C280.091 102.256 280.814 98.9474 282.26 96.2699C283.707 93.5923 285.676 91.438 288.169 89.8068C290.662 88.1757 293.494 86.9446 296.664 86.1136C299.864 85.2827 303.219 84.6979 306.728 84.3594C310.852 83.9285 314.176 83.5284 316.699 83.1591C319.223 82.759 321.054 82.1742 322.193 81.4048C323.332 80.6354 323.901 79.4967 323.901 77.9886V77.7116C323.901 74.7879 322.978 72.5258 321.131 70.9254C319.315 69.325 316.73 68.5249 313.375 68.5249C309.836 68.5249 307.02 69.3097 304.927 70.8793C302.834 72.4181 301.449 74.357 300.772 76.696L282.583 75.2188C283.507 70.91 285.323 67.1861 288.031 64.0469C290.739 60.8769 294.232 58.4455 298.51 56.7528C302.819 55.0294 307.805 54.1676 313.468 54.1676C317.407 54.1676 321.177 54.6293 324.778 55.5526C328.41 56.4759 331.626 57.907 334.426 59.8459C337.258 61.7848 339.489 64.2777 341.12 67.3246C342.752 70.3407 343.567 73.9569 343.567 78.1733V126H324.917V116.167H324.363C323.224 118.383 321.7 120.337 319.792 122.03C317.884 123.692 315.591 125 312.914 125.954C310.236 126.877 307.143 127.339 303.635 127.339ZM309.267 113.766C312.16 113.766 314.714 113.197 316.93 112.058C319.146 110.889 320.885 109.319 322.147 107.349C323.409 105.38 324.039 103.148 324.039 100.656V93.1307C323.424 93.5308 322.578 93.9001 321.5 94.2386C320.454 94.5464 319.269 94.8388 317.946 95.1158C316.622 95.362 315.299 95.5928 313.975 95.8082C312.652 95.9929 311.452 96.1622 310.375 96.316C308.066 96.6546 306.051 97.1932 304.327 97.9318C302.604 98.6705 301.265 99.6707 300.311 100.933C299.357 102.164 298.88 103.702 298.88 105.549C298.88 108.227 299.849 110.273 301.788 111.689C303.758 113.074 306.251 113.766 309.267 113.766ZM396.541 55.0909V69.8636H353.839V55.0909H396.541ZM363.533 38.1023H383.2V104.21C383.2 106.026 383.477 107.442 384.031 108.457C384.585 109.442 385.354 110.135 386.339 110.535C387.354 110.935 388.524 111.135 389.847 111.135C390.771 111.135 391.694 111.058 392.617 110.904C393.54 110.719 394.248 110.581 394.741 110.489L397.834 125.123C396.849 125.431 395.464 125.785 393.679 126.185C391.894 126.616 389.724 126.877 387.17 126.969C382.43 127.154 378.275 126.523 374.705 125.077C371.166 123.63 368.411 121.384 366.442 118.337C364.472 115.29 363.503 111.443 363.533 106.795V38.1023ZM447.069 55.0909V69.8636H404.366V55.0909H447.069ZM414.061 38.1023H433.727V104.21C433.727 106.026 434.004 107.442 434.558 108.457C435.112 109.442 435.881 110.135 436.866 110.535C437.882 110.935 439.051 111.135 440.375 111.135C441.298 111.135 442.221 111.058 443.145 110.904C444.068 110.719 444.776 110.581 445.268 110.489L448.361 125.123C447.376 125.431 445.991 125.785 444.206 126.185C442.421 126.616 440.252 126.877 437.697 126.969C432.958 127.154 428.803 126.523 425.233 125.077C421.693 123.63 418.939 121.384 416.969 118.337C414.999 115.29 414.03 111.443 414.061 106.795V38.1023ZM491.433 127.385C484.139 127.385 477.86 125.908 472.598 122.953C467.366 119.968 463.334 115.751 460.502 110.304C457.671 104.826 456.255 98.3473 456.255 90.8686C456.255 83.5746 457.671 77.1731 460.502 71.6641C463.334 66.1551 467.319 61.8617 472.459 58.7841C477.63 55.7064 483.693 54.1676 490.648 54.1676C495.326 54.1676 499.681 54.9216 503.713 56.4297C507.775 57.907 511.315 60.1383 514.331 63.1236C517.377 66.1089 519.747 69.8636 521.44 74.3878C523.133 78.8812 523.979 84.1439 523.979 90.1761V95.5774H464.103V83.3899H505.467C505.467 80.5585 504.851 78.0502 503.62 75.8651C502.389 73.6799 500.681 71.9718 498.496 70.7408C496.342 69.4789 493.833 68.848 490.971 68.848C487.986 68.848 485.339 69.5405 483.031 70.9254C480.753 72.2796 478.968 74.1108 477.676 76.419C476.383 78.6965 475.721 81.2356 475.691 84.0362V95.6236C475.691 99.1321 476.337 102.164 477.63 104.718C478.953 107.272 480.815 109.242 483.216 110.627C485.616 112.012 488.463 112.705 491.756 112.705C493.941 112.705 495.942 112.397 497.757 111.781C499.573 111.166 501.127 110.242 502.42 109.011C503.713 107.78 504.698 106.272 505.375 104.487L523.564 105.688C522.64 110.058 520.748 113.874 517.885 117.136C515.054 120.368 511.391 122.892 506.898 124.707C502.435 126.492 497.28 127.385 491.433 127.385ZM556.479 85.0057V126H536.813V55.0909H555.556V67.6016H556.387C557.956 63.4775 560.588 60.2152 564.281 57.8146C567.974 55.3833 572.452 54.1676 577.715 54.1676C582.639 54.1676 586.932 55.2448 590.595 57.3991C594.257 59.5535 597.104 62.6312 599.135 66.6321C601.167 70.6023 602.182 75.3419 602.182 80.8508V126H582.516V84.3594C582.547 80.0199 581.439 76.6345 579.192 74.2031C576.945 71.741 573.852 70.5099 569.913 70.5099C567.266 70.5099 564.927 71.0793 562.896 72.218C560.895 73.3568 559.326 75.0187 558.187 77.2038C557.079 79.3582 556.51 81.9588 556.479 85.0057Z" fill="#1E1E1E"/>
            </svg>
          </div>
          <h2 className="mt-6 text-center text-3xl font-extrabold text-gray-900">
            {isSignUp ? 'Create your account' : 'Sign in to your account'}
          </h2>
        </div>
        <form className="mt-8 space-y-6" onSubmit={handleAuth}>
          <div className="rounded-md shadow-sm -space-y-px">
            <div>
              <input
                type="email"
                required
                className="appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm"
                placeholder="Email address"
                value={email}
                onChange={(e) => setEmail(e.target.value)}
              />
            </div>
            <div>
              <input
                type="password"
                required
                className="appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm"
                placeholder="Password"
                value={password}
                onChange={(e) => setPassword(e.target.value)}
              />
            </div>
          </div>

          <div>
            <button
              type="submit"
              disabled={loading}
              className="group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-black hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50"
            >
              {loading ? 'Loading...' : (isSignUp ? 'Sign up' : 'Sign in')}
            </button>
          </div>

          <div className="text-center">
            <button
              type="button"
              onClick={() => setIsSignUp(!isSignUp)}
              className="text-sm text-gray-600 hover:text-gray-900"
            >
              {isSignUp ? 'Already have an account? Sign in' : "Don't have an account? Sign up"}
            </button>
          </div>
        </form>
      </div>
    </div>
  )
} 